(this["webpackJsonpoptions-scanner"]=this["webpackJsonpoptions-scanner"]||[]).push([[0],{165:function(e,t,n){},176:function(e,t,n){},204:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),i=n.n(o),c=(n(85),n(65)),s=n.n(c),u=n(20),l=n.n(u),d=n(3),m=(n(165),n(67)),p=n(77),f=n(21),v=n(68),b=n(69),h=n(22),g=n(79),E=n(78),y=n(70),k=(n(174),n(175),n(176),function(e){Object(g.a)(n,e);var t=Object(E.a)(n);function n(e){var a;return Object(v.a)(this,n),(a=t.call(this,e)).valueChanged=function(e){var t=Object(h.a)(a);a.setState(Object(f.a)({},e.target.name,e.target.value),(function(){a.props.parentFilterInstance((function(e){var n=t.state,a=n.min,r=n.max;return a&&r?e.setModel({filterType:"number",type:"inRange",filter:a,filterTo:r}):a?e.setModel({filterType:"number",type:"greaterThanOrEqual",filter:a}):r?e.setModel({filterType:"number",type:"lessThanOrEqual",filter:r}):e.setModel(null)}))}))},a.state={min:"",max:""},a}return Object(b.a)(n,[{key:"onParentModelChanged",value:function(e){switch(e?e.type:null){case"greaterThan":case"greaterThanOrEqual":return this.setState({min:e.filter});case"lessThan":case"lessThanOrEqual":return this.setState({max:e.filter});case"inRange":return this.setState({min:e.filter,max:e.filterTo});default:return this.setState({min:"",max:""})}}},{key:"render",value:function(){var e={width:"30%",margin:"0 2px",padding:"1px",display:"flex",alignItems:"center"};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{height:"100%"},className:"ag-floating-filter-input"},r.a.createElement("input",{className:"ag-input-field-input ag-text-field-input",style:e,type:"number",value:this.state.min,name:"min",placeholder:"MIN",onChange:this.valueChanged}),r.a.createElement("input",{className:"ag-input-field-input ag-text-field-input",style:e,type:"number",value:this.state.max,name:"max",placeholder:"MAX",onChange:this.valueChanged})))}}]),n}(r.a.Component));var O=Object(d.b)((function(e){return{options:e.tickers.tickers,instruments:e.instruments.instruments}}),null,null,{forwardRef:!0})((function(e){var t=e.options,n=e.instruments,a=[{field:"instrumentName",headerName:"Instrument",comparator:function(e,t,n,a,r){return n.data.expirationTimestamp!==a.data.expirationTimestamp?n.data.expirationTimestamp-a.data.expirationTimestamp:n.data.strike!==a.data.strike?n.data.strike-a.data.strike:n.data.optionType.localeCompare(a.data.optionType)}},{field:"openInterest",filter:"agNumberColumnFilter",headerName:"Open Interest",type:"numericColumn"},{field:"markPrice",filter:"agNumberColumnFilter",headerName:"Mark Price",type:"numericColumn",valueFormatter:function(e){return"$".concat((e.value*e.data.underlyingPrice).toFixed(2)," (").concat(e.value.toFixed(8),")")}},{field:"markIv",filter:"agNumberColumnFilter",headerName:"IV (Mark)",type:"numericColumn",valueFormatter:function(e){return"".concat(e.value.toFixed(2))}}].concat(Object(p.a)([{headerName:"Delta",field:"greeks.delta"},{headerName:"Gamma",field:"greeks.gamma"},{headerName:"Vega",field:"greeks.vega"},{headerName:"Theta",field:"greeks.theta"}].map((function(e){return Object.assign(e,{filter:"agNumberColumnFilter",floatingFilterComponent:"customNumberMinMaxFilter",floatingFilterComponentParams:{suppressFilterButton:!0},type:"numericColumn",valueFormatter:function(e){return"".concat(e.value.toFixed(5))}})})))),o=l()(t,(function(e,t){return Object(m.a)({},n[t],{},e)}));return r.a.createElement("div",{id:"grid-wrapper"},r.a.createElement("div",{className:"ag-theme-balham-dark",style:{height:"95vh",width:"100%"}},r.a.createElement(y.AgGridReact,{onGridReady:function(e){e.api.sizeColumnsToFit()},floatingFilter:!0,columnDefs:a,defaultColDef:{filter:!0,resizable:!0,sortable:!0},rowData:o,deltaRowDataMode:!0,getRowNodeId:function(e){return e.instrumentName},frameworkComponents:{customNumberMinMaxFilter:k}})))})),N=n(5),C=Object(N.b)({name:"websocket",initialState:{isOpen:!1},reducers:{open:function(e){e.isOpen=!0},close:function(e){e.isOpen=!1}}}),w=C.actions,S=function(e){return e.websocket.isOpen},T=C.reducer,x=n(41),j=n.n(x),L=n(1),I=n.n(L),R=n(71),A=n.n(R),D=n(72),F=n.n(D),W=n(73),M=n.n(W),P=n(74),G=n.n(P),J=new A.a("wss://www.deribit.com/ws/api/v2",null,{automaticOpen:!1});J.addEventListener("message",(function(e){var t=new CustomEvent("json");t.data=function e(t){return M()(t)?G()(t,(function(t,n,a){return t[F()(a)]=e(n),t}),{}):I()(t)?t.map((function(t){return e(t)})):t}(JSON.parse(e.data)),J.dispatchEvent(t)})),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=null,a=1e4,r=2e3,o=function(){clearTimeout(n),n=setTimeout((function(){return console.warn("Connection is stale, no message received in ".concat(a/1e3," seconds")),t()}),a+r)};e.addEventListener("open",(function(){e.send(JSON.stringify({method:"public/set_heartbeat",params:{interval:Math.max(parseInt(a/1e3,10),10)},jsonrpc:"2.0",id:Date.now()}))})),e.addEventListener("close",(function(){clearTimeout(n)})),e.addEventListener("json",(function(t){o();var n=t.data;"heartbeat"===n.method&&"test_request"===n.params.type&&e.send(JSON.stringify({method:"public/test",params:{},jsonrpc:"2.0",id:Date.now()}))}))}(J,J.refresh);var q={};J.addEventListener("open",(function(e){J.send(JSON.stringify({method:"public/subscribe",params:{channels:Object.keys(q)},jsonrpc:"2.0",id:Date.now()}))})),J.addEventListener("json",(function(e){var t=e.data;if("subscription"===t.method){var n=t.params,a=n.channel,r=n.data;q[a]?q[a](r):console.log("Ignoring subscription: ",a)}}));var B=J;function _(){var e=Object(d.c)();r.a.useEffect((function(){return B.open(),B.addEventListener("open",(function(){e(w.open()),console.debug("Connection to Deribit opened")})),B.addEventListener("close",(function(){e(w.close()),console.debug("Connection to Deribit closed")}),{once:!0}),function(){console.log("Closing connection to Deribit"),B.close()}}),[e]);var t=Object(d.d)(S),n={backgroundColor:t?"#7aae1a":"#ff1111",borderRadius:"50%",marginRight:"8px",display:"inline-block",height:"12px",width:"12px"};return r.a.createElement("div",{style:{marginLeft:"4px",marginBottom:"4px"}},r.a.createElement("span",{style:n}),t?"Online":"Connecting...")}var z=Object(N.b)({name:"tickers",initialState:{tickers:{}},reducers:{update:function(e,t){var n=t.payload;e.tickers[n.instrumentName]=n}}}),V=z.actions,$=z.reducer,X=n(75),H=n.n(X),K=n(76),Q=n.n(K),U=Object(N.b)({name:"instruments",initialState:{instruments:{}},reducers:{success:function(e,t){var n=t.payload;e.instruments=n}}}),Y=function(){return function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.timeout,a=void 0===n?1e4:n;return new Promise((function(t,n){var r=setTimeout(n,a,new Error("Call timed out")),o=Date.now(),i=JSON.stringify({method:e.method,params:e.params,jsonrpc:"2.0",id:o});1===J.readyState?J.send(i):J.addEventListener("open",(function(){return J.send(i)}),{once:!0}),J.addEventListener("json",(function e(n){var a=n.data;if(a.id===o)return J.removeEventListener("message",e),clearTimeout(r),t(a)}))}))}({method:"public/get_instruments",params:{currency:"BTC",kind:"option",expired:!1}}).then((function(e){return e.result})).then((function(e){return H()(e,["expirationTimestamp","strike","optionType"],["asc","asc","asc"])})).then((function(e){return Q()(e,"instrumentName")})).then((function(t){return e(U.actions.success(t))}))}},Z=function(e){return e.instruments.instruments},ee=U.reducer;var te=function(){var e=Object(d.c)(),t=Object(d.d)(Z);return r.a.useEffect((function(){e(Y())}),[e]),r.a.useEffect((function(){if(!s()(t)){var n=l()(t,(function(e){return"ticker.".concat(e.instrumentName,".100ms")}));return function(e,t){var n=j()(e);n.forEach((function(e,n){q[e]=I()(t)?t[n]:t}));var a=JSON.stringify({method:"public/subscribe",params:{channels:n},jsonrpc:"2.0",id:Date.now()});1===J.readyState?J.send(a):J.addEventListener("open",(function(){return J.send(a)}),{once:!0})}(n,(function(t){return e(V.update(t))})),function(){return function(e){var t=j()(e);t.forEach((function(e){delete t[e]}));var n=JSON.stringify({method:"public/unsubscribe",params:{channels:t},jsonrpc:"2.0",id:Date.now()});1===J.readyState?J.send(n):J.addEventListener("open",(function(){return J.send(n)}),{once:!0})}(n)}}return function(){}}),[e,t]),r.a.createElement("div",{className:"App"},r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",null,r.a.createElement(_,null)),r.a.createElement("h3",{style:{margin:"0.5rem"}},"Deribit Option Scanner"),r.a.createElement("div",null)),r.a.createElement(O,null))},ne=Object(N.a)({middleware:Object(N.c)({thunk:!0,immutableCheck:!1,serializableCheck:!1}),reducer:{instruments:ee,tickers:$,websocket:T}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(d.a,{store:ne},r.a.createElement(te,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},71:function(e,t,n){var a,r,o;r=[],void 0===(o="function"===typeof(a=function(){if("WebSocket"in window)return e.prototype.onopen=function(e){},e.prototype.onclose=function(e){},e.prototype.onconnecting=function(e){},e.prototype.onmessage=function(e){},e.prototype.onerror=function(e){},e.debugAll=!1,e.CONNECTING=WebSocket.CONNECTING,e.OPEN=WebSocket.OPEN,e.CLOSING=WebSocket.CLOSING,e.CLOSED=WebSocket.CLOSED,e;function e(t,n,a){var r={debug:!1,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:null,binaryType:"blob"};for(var o in a||(a={}),r)"undefined"!==typeof a[o]?this[o]=a[o]:this[o]=r[o];this.url=t,this.reconnectAttempts=0,this.readyState=WebSocket.CONNECTING,this.protocol=null;var i,c=this,s=!1,u=!1,l=document.createElement("div");function d(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}l.addEventListener("open",(function(e){c.onopen(e)})),l.addEventListener("close",(function(e){c.onclose(e)})),l.addEventListener("connecting",(function(e){c.onconnecting(e)})),l.addEventListener("message",(function(e){c.onmessage(e)})),l.addEventListener("error",(function(e){c.onerror(e)})),this.addEventListener=l.addEventListener.bind(l),this.removeEventListener=l.removeEventListener.bind(l),this.dispatchEvent=l.dispatchEvent.bind(l),this.open=function(t){if((i=new WebSocket(c.url,n||[])).binaryType=this.binaryType,t){if(this.maxReconnectAttempts&&this.reconnectAttempts>this.maxReconnectAttempts)return}else l.dispatchEvent(d("connecting")),this.reconnectAttempts=0;(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",c.url);var a=i,r=setTimeout((function(){(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",c.url),u=!0,a.close(),u=!1}),c.timeoutInterval);i.onopen=function(n){clearTimeout(r),(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onopen",c.url),c.protocol=i.protocol,c.readyState=WebSocket.OPEN,c.reconnectAttempts=0;var a=d("open");a.isReconnect=t,t=!1,l.dispatchEvent(a)},i.onclose=function(n){if(clearTimeout(r),i=null,s)c.readyState=WebSocket.CLOSED,l.dispatchEvent(d("close"));else{c.readyState=WebSocket.CONNECTING;var a=d("connecting");a.code=n.code,a.reason=n.reason,a.wasClean=n.wasClean,l.dispatchEvent(a),t||u||((c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onclose",c.url),l.dispatchEvent(d("close")));var r=c.reconnectInterval*Math.pow(c.reconnectDecay,c.reconnectAttempts);setTimeout((function(){c.reconnectAttempts++,c.open(!0)}),r>c.maxReconnectInterval?c.maxReconnectInterval:r)}},i.onmessage=function(t){(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",c.url,t.data);var n=d("message");n.data=t.data,l.dispatchEvent(n)},i.onerror=function(t){(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onerror",c.url,t),l.dispatchEvent(d("error"))}},1==this.automaticOpen&&this.open(!1),this.send=function(t){if(i)return(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","send",c.url,t),i.send(t);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(e,t){"undefined"==typeof e&&(e=1e3),s=!0,i&&i.close(e,t)},this.refresh=function(){i&&i.close()}}})?a.apply(t,r):a)||(e.exports=o)},80:function(e,t,n){e.exports=n(204)},85:function(e,t,n){}},[[80,1,2]]]);
//# sourceMappingURL=main.7a4690ef.chunk.js.map